<form action="/listings" method="post">
  <button id="post_listing" type="submit">Post</button>
  <br>

  <input id="listing_name" type="text" name="name" placeholder="Name" required>
  <input id="listing_description" type="text" name="description" placeholder="Description" required>
  <input id="listing_price" type="number" name="price" placeholder="Price" min='5' max='25000' required>
  <br>

  <label for="start_date0">Start date:</label>
  <input type="date" id="start_date0" name="start_date0" value="<%= Time.now.strftime("%F") %>" min="2019-12-01" max="2025-12-31">
  <label for="end_date0">End date:</label>
  <input type="date" id="end_date0" name="end_date0" value="<%= (Time.now+86400).strftime("%F") %>" min="2019-12-01" max="2025-12-31">
  <button type='button' id='add_availability' onclick='addAvailability(1)'>Add availabilty</button>
</form>

<script>
  function addAvailability(date_index) {
    const container = $('form');
    
    const button = $('#add_availability');
    button.remove();
    container.append('<br>');

    const start = document.createElement('input');
    start.type = 'date';
    start.id = `start_date${date_index}`;
    start.name = `start_date${date_index}`;
    start.value = $(`#end_date${date_index-1}`).val();

    container.append(`<label for='start_date${date_index}'>Start date:</label>`);
    container.append(start);

    const end = document.createElement('input');
    end.type = 'date';
    end.id = `end_date${date_index}`;
    end.name = `end_date${date_index}`;
    end.value = $(`#end_date${date_index-1}`).val();

    container.append(`<label for='end_date${date_index}'>Start date:</label>`);
    container.append(end);

    container.append(`<button type='button' id='add_availability' onclick='addAvailability(${date_index+1})'>Add availability</button>`);
  }
</script>
